// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider     = "mysql"
  url          = env("DATABASE_URL")
  relationMode = "prisma"
}

enum IntentStatus {
  Inactive
  Active
  Paused
  Cancelled
  Deleted
}

model Intent {
  id         Int      @id @default(autoincrement())
  startDate  DateTime
  endDate    DateTime
  status     IntentStatus
  isPublic   Boolean
  successYes Int
  successNo  Int
  reminders  String // Or JSON?
  userId     Int
  aimId      Int

  // Relationships
  user User  @relation("UserIntents", fields: [userId], references: [id])
  aim  Aim   @relation("AimIntents", fields: [aimId], references: [id])
  tags Tag[] @relation("IntentTags")

  // Indexes
  @@index([userId], name: "userId_index")
  @@index([aimId], name: "aim_id_index")
}

enum UserRole {
  User
  GroupManager
  Admin
}

model User {
  id        Int    @id @default(autoincrement())
  firstName String
  lastName  String
  role      UserRole
  timezone  String

  // Relationships
  intents Intent[] @relation("UserIntents")
  groups  Group[]  @relation("GroupMembers")
  aims    Aim[]    @relation("AimParticipants")
  tags    Tag[]    @relation("UserTags")
}

model Group {
  id    Int    @id @default(autoincrement())
  title String

  // Relationships
  users User[] @relation("GroupMembers")
  aims  Aim[]  @relation("GroupAims")
  tags  Tag[]  @relation("GroupTags")
}

model Aim {
  id              Int    @id @default(autoincrement())
  title           String
  helpfulnessLow  Int
  helpfulnessMid  Int
  helpfulnessHigh Int

  // Relationships
  groups  Group[]  @relation("GroupAims")
  intents Intent[] @relation("AimIntents")
  tags    Tag[]    @relation("AimTags")
  users   User[]   @relation("AimParticipants")

  // Indexes
  @@index([helpfulnessLow], name: "helpfulnessLow_index") // Add an index on the 'low' column
  @@index([helpfulnessMid], name: "helpfulnessMid_index") // Add an index on the 'mid' column
  @@index([helpfulnessHigh], name: "helpfulnessHigh_index") // Add an index on the 'high' column
}

model Tag {
  id    Int    @id @default(autoincrement())
  title String

  // Relationships
  aims    Aim[]    @relation("AimTags")
  groups  Group[]  @relation("GroupTags")
  users   User[]   @relation("UserTags")
  intents Intent[] @relation("IntentTags")
}
